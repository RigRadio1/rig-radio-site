<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>Create Account • Rig-Radio</title>
  <style>
    :root {
      --bg:#0b0f14;
      --panel:#0f151d;
      --text:#e6e9ee;
      --muted:#a6b0be;
      --red:#ff2b2b;
      --red-glow:0 0 0.5rem rgba(255,43,43,.6), 0 0 1.1rem rgba(255,43,43,.35), inset 0 0 .2rem rgba(255,43,43,.25);
      --card-glow:0 0 .8rem rgba(255,43,43,.35), 0 0 2rem rgba(255,43,43,.25);
      --ring:0 0 0 3px rgba(255,43,43,.55);
    }
    * { box-sizing: border-box; }
    html,body { height:100%; }
    body {
      margin:0;
      background:
        url("studio-bg.png") center/cover no-repeat fixed,
        radial-gradient(1200px 600px at 20% -20%, rgba(255,43,43,.06), transparent 50%),
        radial-gradient(900px 600px at 120% 10%, rgba(255,43,43,.05), transparent 50%),
        linear-gradient(180deg, #0b0f14 0%, #0a0d12 100%);
      color:var(--text);
      font-family: system-ui, -apple-system, Segoe UI, Roboto, Ubuntu, Cantarell, "Helvetica Neue", Arial;
      letter-spacing:.2px;
    }
    .smoke:before {
      content:"";
      position:fixed; inset:0;
      background:
        radial-gradient(1200px 800px at 70% -10%, rgba(255,255,255,.03), transparent 40%),
        radial-gradient(900px 700px at -10% 110%, rgba(255,255,255,.025), transparent 40%);
      pointer-events:none;
      mix-blend-mode:screen;
      filter: blur(8px);
    }
    .container {
      display:flex;
      align-items:center;
      justify-content:center;
      height:100%;
    }
    .card {
      background:var(--panel);
      padding:2rem;
      border-radius:12px;
      box-shadow:var(--card-glow);
      width:100%;
      max-width:400px;
    }
    .field { margin-bottom:1.2rem; }
    .label { margin-bottom:.4rem; font-weight:600; }
    .input {
      width:100%;
      padding:.75rem;
      border-radius:8px;
      border:1px solid #333;
      background:#11161d;
      color:var(--text);
    }
    .input.is-danger { border:1px solid #ff4d4d !important; box-shadow:0 0 8px rgba(255,0,0,.35); }
    .help.is-danger { color:#ff4d4d; font-size:.85rem; margin-top:.4rem; }
    .cta {
      background:var(--red);
      border:none;
      border-radius:8px;
      padding:.75rem;
      width:100%;
      color:#fff;
      font-weight:bold;
      cursor:pointer;
      box-shadow:var(--red-glow);
      transition:.2s;
    }
    .cta:disabled { opacity:.6; cursor:not-allowed; }
  </style>
</head>
<body class="smoke">
  <div class="container">
    <div class="card">
      <h2>Create Account</h2>

      <div class="field">
        <div class="label">Display Name</div>
        <input class="input" type="text" id="displayName" name="displayName" placeholder="Your handle" />
      </div>

      <div class="field">
        <div class="label">Email</div>
        <input class="input" type="email" id="email" name="email" placeholder="you@rig-radio.ai" />
      </div>

      <!-- Confirm Email -->
      <div class="field">
        <div class="label">Confirm Email</div>
        <input class="input" type="email" id="confirmEmail" name="confirmEmail" placeholder="Confirm your email" aria-describedby="confirmEmailError" required />
        <p id="confirmEmailError" class="help is-danger"></p>
      </div>

      <div class="field">
        <div class="label">Password</div>
        <input class="input" type="password" id="password" name="password" placeholder="••••••••" />
      </div>

      <div class="field">
        <div class="label">Confirm Password</div>
        <input class="input" type="password" id="passwordConfirm" name="passwordConfirm" placeholder="••••••••" />
      </div>

      <button class="cta" type="button" id="createAccountBtn">Create Account</button>
      <p style="margin-top:1rem;">Already have an account? <a href="login.html">Log in</a></p>
    </div>
  </div>

  <!-- Supabase init -->
  <script src="https://cdn.jsdelivr.net/npm/@supabase/supabase-js@2"></script>
  <script>
    const SUPABASE_URL  = "https://tpzpeoqdpfwqumlsyhpx.supabase.co";
    const SUPABASE_ANON = "eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6InRwenBlb3FkcGZ3cXVtbHN5aHB4Iiwicm9sZSI6ImFub24iLCJpYXQiOjE3NTcwMDM5NTEsImV4cCI6MjA3MjU3OTk1MX0.nP8W_G_N9GKucj6tlzyvSAOjhiqTBD-F564i0gNhp8E";

    const sb = window.supabase.createClient(SUPABASE_URL, SUPABASE_ANON, {
      auth: { persistSession: true, autoRefreshToken: true }
    });
  </script>

  <!-- Confirm Email validation -->
  <script>
    document.addEventListener("DOMContentLoaded", function () {
      const email = document.getElementById("email");
      const confirmEmail = document.getElementById("confirmEmail");
      const err = document.getElementById("confirmEmailError");
      function normalize(v){ return (v||"").trim().toLowerCase(); }
      function showError(msg){
        err.textContent = msg || "";
        confirmEmail.classList.toggle("is-danger", !!msg);
        document.getElementById("createAccountBtn").disabled = !!msg;
      }
      function validate(){
        const a = normalize(email.value);
        const b = normalize(confirmEmail.value);
        if (!b){ showError(""); return true; }
        if (a!==b){ showError("Email addresses do not match."); return false; }
        showError(""); return true;
      }
      email.addEventListener("input", validate);
      confirmEmail.addEventListener("input", validate);
    });
  </script>

  <!-- Sign-up handler -->
  <script>
    document.addEventListener("DOMContentLoaded", function () {
      const btn = document.getElementById("createAccountBtn");
      const email = document.getElementById("email");
      const password = document.getElementById("password");
      const passwordConfirm = document.getElementById("passwordConfirm");
      const displayName = document.getElementById("displayName");

      async function doSignUp(){
        if (!email.value || !password.value){
          alert("Email and password are required.");
          return;
        }
        if (password.value !== passwordConfirm.value){
          alert("Passwords do not match.");
          return;
        }
        btn.disabled = true; btn.textContent="Creating...";

        const { data, error } = await sb.auth.signUp({
          email: email.value.trim(),
          password: password.value,
          options: {
            data: { display_name: displayName.value.trim() },
            emailRedirectTo: `${location.origin}/login.html`
          }
        });

        if (error){ alert("Sign up failed: " + error.message); }
        else { alert("Account created! Check your email to confirm."); window.location.href="/login.html"; }

        btn.disabled = false; btn.textContent="Create Account";
      }

      btn.addEventListener("click", doSignUp);
    });
  </script>
</body>
</html>

