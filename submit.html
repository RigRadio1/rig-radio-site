<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="utf-8"/>
  <meta name="viewport" content="width=device-width, initial-scale=1"/>
  <title>Submit a Track ‚Äî Rig-Radio</title>

  <!-- Global theme -->
  <link rel="stylesheet" href="/rr.css"/>

  <style>
    /* page-local touches only */
    .layout{display:grid;grid-template-columns:260px 1fr;gap:18px}
    @media (max-width:900px){ .layout{grid-template-columns:1fr} }
    .sidebar{background:rgba(8,10,16,.72);border:1px solid #2a1a1e;border-radius:16px;padding:12px}
    .content{min-width:0}
    .signed{margin:6px 0 14px;opacity:.85}
    .steps{list-style:none;margin:0;padding:0}
    .steps li{display:flex;align-items:center;gap:10px;margin:8px 0;padding:10px 12px;background:rgba(8,10,16,.72);border:1px solid #2a1a1e;border-radius:12px;color:#b9b9c8}
    .steps li .num{width:28px;height:28px;border-radius:999px;display:grid;place-items:center;background:#13131a;border:1px solid #2a1a1e;font-weight:700}
    .steps li.active{color:#fff;box-shadow:0 0 0 2px rgba(255,42,58,.25) inset, 0 18px 50px rgba(0,0,0,.35)}
    .steps li.done{opacity:.75}
    .stage{display:none;background:rgba(8,10,16,.88);padding:16px;border-radius:16px;box-shadow:0 0 0 2px rgba(255,42,58,.25)}
    .stage.active{display:block}
    .progressbar{width:100%;height:6px;border-radius:8px;background:rgba(255,255,255,.06);box-shadow:inset 0 0 0 1px rgba(255,255,255,.05);margin:6px 0 16px}
    .progressbar>.bar{height:100%;width:0%;background:linear-gradient(90deg, rgba(255,42,58,.6), rgba(255,89,100,.95));box-shadow:0 0 14px rgba(255,42,58,.25), 0 0 3px rgba(255,42,58,.45) inset;border-radius:8px;transition:width .25s ease}
    .rr-label{display:block;margin:4px 0 6px;font-weight:700;color:#cfcfe5}
    .rr-actions{margin-top:14px;display:flex;gap:10px}
    /* ensure the dropzone looks good here too */
    .dropzone{display:flex;align-items:center;justify-content:center;height:160px;border-radius:12px;border:2px dashed rgba(255,42,58,.35);background:rgba(15,10,12,.7);color:#f0f0f5;text-align:center;transition:.15s ease box-shadow,.15s ease transform,.15s ease border-color}
    .dropzone strong{color:#fff}
    .dropzone.hover{border-color:#ff2a3a;box-shadow:0 0 22px rgba(255,42,58,.35), inset 0 0 0 1px rgba(255,42,58,.35);transform:scale(1.01)}
    .preview-img{width:160px;height:160px;object-fit:cover;border-radius:12px;border:1px solid #34171c;background:#0c0d12}
  </style>
</head>
<body class="rr-bg">
<div id="bg"></div>

  <!-- Top bar -->
  <header class="rr-topbar">
    <div class="rr-topbar-left">Submit a Track</div>
    <nav class="rr-topbar-right">
      <a class="rr-link" href="/dashboard">Dashboard</a>
      <a class="rr-link" href="/library">Library</a>
    </nav>
  </header>

  <main class="wrap">
    <div class="signed" id="signed-in-email">Signed in‚Ä¶</div>

    <div class="layout">
      <!-- Left rail -->
      <aside class="sidebar">
        <ul class="steps">
          <li data-step="1" class="active"><span class="num">1</span><div><strong>Upload Audio</strong><br><small class="rr-muted">MP3's ONLY</small></div></li>
          <li data-step="2"><span class="num">2</span><div><strong>Details &amp; Tags</strong><br><small class="rr-muted">Title, artist, genre</small></div></li>
          <li data-step="3"><span class="num">3</span><div><strong>Cover Art</strong><br><small class="rr-muted">PNG/JPG only</small></div></li>
          <li data-step="4"><span class="num">4</span><div><strong>Rights &amp; Release</strong><br><small class="rr-muted">Usage &amp; license</small></div></li>
          <li data-step="5"><span class="num">5</span><div><strong>Publish</strong><br><small class="rr-muted">Preview &amp; confirm</small></div></li>
        </ul>
      </aside>

      <!-- Right content -->
      <section class="content">

        <div class="progressbar"><div class="bar" id="progress"></div></div>

        <!-- STEP 1 -->
        <section class="stage active" data-step="1">
          <h2>Step 1 ‚Äî Upload Audio</h2>
          <p class="rr-muted">Drag &amp; drop your MP3's HERE (max 20‚ÄâMB), or click to choose a file.</p>

          <div id="audioDrop" class="dropzone" role="button" tabindex="0" aria-label="Audio dropzone">
            <div>
              <strong>Drag &amp; drop</strong> your track here, or <u>click to browse</u>.<br>
              <small class="rr-muted">Accepted: MP3's ONLY ‚Äî max 20‚ÄâMB</small>
            </div>
          </div>

          <input id="audioFile" type="file" accept=".mp3,.wav,.flac,audio/mpeg,audio/wav,audio/flac" hidden>

          <div class="rr-actions">
            <span id="audioStatus" class="rr-muted"></span>
            <div style="margin-left:auto;display:flex;gap:10px">
              <button type="button" class="rr-btn rr-primary" id="toStep2" disabled>Next ‚Üí</button>
            </div>
          </div>
        </section>

        <!-- STEP 2 -->
        <section class="stage" data-step="2">
          <h2>Step 2 ‚Äî Details &amp; Tags</h2>

          <div class="rr-grid-2">
            <div>
              <label for="title" class="rr-label">Song Title *</label>

<input id="title" type="text" maxlength="25" placeholder="Song title (max 25)"
       oninput="this.value=this.value.replace(/[^A-Za-z0-9 ]+/g,'').slice(0,25)">


            </div>
            <div>
              <label for="artist" class="rr-label">Artist *</label>

<input id="artist" type="text" maxlength="25" placeholder="Artist name (max 25)"
       oninput="this.value=this.value.replace(/[^A-Za-z0-9 ]+/g,'').slice(0,25)">



            </div>
            <div>
              <label for="genre" class="rr-label">Genre *</label>
              <select id="genre">
                <option value="">Select‚Ä¶</option>
                <option>Rock</option><option>Metal</option><option>Pop</option>
                <option>Hip-Hop</option><option>EDM</option><option>House</option>
                <option>Techno</option><option>Drum &amp; Bass</option><option>Ambient</option>
                <option>Jazz</option><option>Blues</option><option>Country</option>
                <option>Folk</option><option>Classical</option><option>R&amp;B</option>
                <option>Reggae</option><option>Indie</option><option>Other</option>
              </select>
            </div>
            <div>
              <label for="notes" class="rr-label">Notes (optional)</label>

<textarea id="notes" maxlength="50" placeholder="Anything we should know? (max 50)"
          oninput="this.value=this.value.replace(/[^A-Za-z0-9 ]+/g,'').slice(0,50)"></textarea>



            </div>
          </div>

          <div class="rr-actions">
            <button type="button" class="rr-btn rr-ghost" data-back>Back</button>
            <button type="button" class="rr-btn rr-primary" id="toStep3" disabled>Next ‚Üí</button>
          </div>
        </section>

        <!-- STEP 3 -->
        <section class="stage" data-step="3">
          <h2>Step 3 ‚Äî Cover Art</h2>
          <p class="rr-muted">Upload a square PNG or JPG (recommended 1000√ó1000 or larger).</p>

          <div class="rr-grid-2">
            <div>
              <label for="coverFile" class="rr-label">Cover image (PNG/JPG) *</label>
              <input id="coverFile" type="file" accept=".png,.jpg,.jpeg,image/png,image/jpeg"/>
              <small class="rr-help">Max ~5‚Äì10MB recommended. No GIFs or videos.</small>
            </div>

            <div>
              <label class="rr-label">Preview</label>
              <img id="coverPreview" class="preview-img" src="/banner.png" alt="cover preview"/>
            </div>
          </div>

          <div class="rr-actions">
            <button type="button" class="rr-btn rr-ghost" data-back>Back</button>
            <button type="button" class="rr-btn rr-primary" id="toStep4" disabled>Next ‚Üí</button>
          </div>
        </section>

        <!-- STEP 4 -->
        <section class="stage" data-step="4">
          <h2>Step 4 ‚Äî Rights &amp; Release</h2>
          <p class="rr-muted">You confirm you have the rights to upload and share this track on Rig-Radio.</p>
          <label><input type="checkbox" id="agree"> I own (or have permission to use) the audio and artwork, and agree to the terms.</label>

          <div class="rr-actions">
            <button type="button" class="rr-btn rr-ghost" data-back>Back</button>
            <button type="button" class="rr-btn rr-primary" id="toStep5" disabled>Next ‚Üí</button>
          </div>
        </section>

        <!-- STEP 5 -->
        <section class="stage" data-step="5">
          <h2>Step 5 ‚Äî Publish</h2>
          <div id="publishSummary" class="card" style="margin-bottom:12px"></div>

          <div class="rr-actions">
            <button type="button" class="rr-btn rr-ghost" data-back>Back</button>
            <button type="button" class="rr-btn rr-primary" id="publishBtn">Publish</button>
            <span id="publishStatus" class="rr-muted" style="margin-left:auto"></span>
          </div>
        </section>

      </section>
    </div>

<div class="upload-warning">
  ‚ö†Ô∏è <strong>TEXT-ONLY:</strong> Please title your files clearly:
  <br>‚Ä¢ Use only the song name (example: <code>MySong.mp3</code>)
  <br>‚Ä¢ No special characters (‚ùå %, $, #, @)
  <br>‚Ä¢ No images/emotes (‚ùå üòä üéµ)
  <br>‚Ä¢ Do not use ALL CAPITAL LETTERS
</div>



  </main>

  <!-- Supabase SDK + your client + wizard -->
  <script src="https://cdn.jsdelivr.net/npm/@supabase/supabase-js@2"></script>
  <script src="/rr-supabase.js"></script>
  <script src="/submit-wizard.js"></script>
  <!-- Background loader (same as teaser/dashboard) -->
  <script>
    (async () => {
      const bg = document.getElementById("bg");
      const pages = ["/", "/index.html"];
      let html = "";
      for (const p of pages) {
        try {
          const r = await fetch(p,{cache:"no-cache"});
          if (r.ok) { html = await r.text(); break; }
        } catch {}
      }
      let path = null;
      if (html){
        const re=/url\((['"]?)(\/[^'")]+\.(?:jpg|jpeg|png|webp))\1\)/ig;
        const m=[...html.matchAll(re)].map(x=>x[2]);
        if (m.length) path=m[0];
      }
      const fallbacks=[
        "/img/rig-radio-studio.jpg","/images/rig-radio-studio.jpg","/rig-radio-studio.jpg",
        "/images/studio-bg.jpg","/img/studio-bg.jpg","/studio-bg.jpg","/studio-bg.png"
      ];
      const candidates = path ? [path, ...fallbacks] : fallbacks;
      for (const c of candidates) {
        try {
          const r=await fetch(c,{cache:"no-cache"});
          if (r.ok){ bg.style.backgroundImage=`url('${c}')`; return; }
        } catch {}
      }
    })();

<script>
  // Allow only letters, numbers, and spaces. Block emojis/symbols/markup.
  (function(){
    const onlyTextNums = /[^A-Za-z0-9 ]+/g; // remove anything NOT A-Z a-z 0-9 or space

    function enforce(el, max){
      if (!el) return;
      const v = el.value || "";
      // strip disallowed chars, trim to max length
      const cleaned = v.replace(onlyTextNums, "").slice(0, max);
      if (cleaned !== v) el.value = cleaned;
    }

    function wire(id, max){
      const el = document.getElementById(id);
      if (!el) return;
      // enforce on input & blur
      el.addEventListener("input", () => enforce(el, max));
      el.addEventListener("blur",  () => enforce(el, max));
      // one initial scrub in case browser restored values
      enforce(el, max);
    }

    // Title (25), Artist (25), Notes (100)
    wire("title",  25);
    wire("artist", 25);
    wire("notes",  100);
  })();
</script>


  </script>


</body>
</html>

